# Робот + ROS 2

## Загальна характеристика 

Даний проєкт реалізує програмно-апаратний комплекс керування мобільною роботизованою платформою з використанням фреймворку ROS 2. Система забезпечує взаємодію між обчислювальним модулем Raspberry Pi, драйверами двигунів постійного струму, камерою та програмними вузлами керування.

---

## Програмне та апаратне забезпечення

Для коректної роботи системи необхідно забезпечити наявність наступного програмного та апаратного середовища.

Апаратна частина включає:

* Raspberry Pi  5
* драйвер двигунів типу L298N 
* два двигуни постійного струму
* камера, сумісна з Linux та ROS 2
* блок живлення 

Програмна частина включає:

* операційну систему Ubuntu Server 24.04 LTS,
* встановлену версію ROS 2 (Jazzy),
* середовище розробки colcon,
* Python 3,
* бібліотеки rclpy, OpenCV, cv_bridge.

---

## Структура проєкту
Основний функціонал зосереджений у двох програмних вузлах: motor_node та camera_node. Для одночасного запуску використовується launch-файл.

---

#  Встановлення Ubuntu та ROS 2 на Raspberry Pi

## 1. Встановлення Ubuntu через Raspberry Pi Imager

### Кроки:

1. Завантаж Raspberry Pi Imager з офіційного сайту Raspberry Pi.
2. Встав MicroSD-карту в комп’ютер.
3. Запусти Raspberry Pi Imager.
4. У полі **Operating System** обери:

   ```
   Other general-purpose OS → Ubuntu → Ubuntu Server (64-bit)
   ```
5. У полі **Storage** обери свою SD-карту.
6. (Опціонально) Натисни  → налаштуй:

   * Wi-Fi
   * Username / Password
   * SSH
7. Натисни **Write** та дочекайся завершення запису.
8. Встав SD-карту в Raspberry Pi та увімкни живлення.

Після завантаження система буде доступна через монітор або SSH.

---

## 2. Початкове налаштування Ubuntu

Після першого входу:

Онови систему:

```bash
sudo apt update
sudo apt upgrade -y
```

Встанови базові утиліти:

```bash
sudo apt install -y curl wget git net-tools
```

Перезавантаж:

```bash
sudo reboot
```

---

## 3. Встановлення ROS 2

---

Оноввлення пакетів:

```bash
sudo apt update

sudo apt install -y ros-jazzy-ros-base
```

---

### 3.1 Налаштування середовища

Активація ROS 2:

```~/.bashrc
source /opt/ros/humble/setup.bash
```

Щоб автоматично завантажити:

```~/.bashrc
source /opt/ros/humble/setup.bash" 
```

---

## 4. Встановлення ROS-інструментів

```bash
sudo apt install -y \
python3-colcon-common-extensions \
python3-rosdep \
python3-argcomplete
```

---
# Перейдемо до опису вузлів робота

## Опис вузла motor_node

Вузол motor_node відповідає за керування рухом мобільної платформи.

Основними функціями вузла є:

* підписка на топік `/cmd_vel`,
* обробка лінійної та кутової швидкості,
* генерація PWM-сигналів,
* керування напрямком обертання двигунів,
* реалізація розвороту на місці.

Вузол приймає повідомлення типу `geometry_msgs/Twist` та інтерпретує їх наступним чином:

* `linear.x` — швидкість руху вперед або назад,
* `angular.z` — швидкість обертання навколо осі.

Для забезпечення стабільності зв’язку використовується налаштований профіль QoS з параметрами надійної доставки та обмеженої глибини черги.

Керування двигунами здійснюється через GPIO з використанням PWM.

---

## Опис вузла camera_node

Вузол camera_node призначений для захоплення, обробки та трансляції відеопотоку з камери.

Основними функціями вузла є:

* ініціалізація камери,
* зчитування відеокадрів,
* конвертація у формат ROS,
* публікація в топік `/image_raw`,
* оптимізація QoS для потокових даних.

Очищення буфера дозволяє уникнути накопичення застарілих кадрів та зменшує затримку передачі зображення.

---

## Опис launch-файлу

Launch-файл `robot_launch.py` забезпечує централізований запуск усіх компонентів системи.

Під час запуску відбувається:

* ініціалізація вузла motor_node,
* ініціалізація вузла camera_node,
* встановлення параметрів QoS,
* синхронізація запуску компонентів.

Використання launch-файлу дозволяє мінімізувати ручну конфігурацію та забезпечує відтворюваність експериментів.

---

## Запуск системи

### для запуску робота потбрібно:
1) Провести компіляцію та збірку проєкту
   1. `~cd/ros2_ws `
   2. `colcon build`
   3. `source install/setup.bash` 

2)  Потім потрібно зробити запуск системи. Запуск можна зробтити одним launch-файлом або ж кожну ноду окремо 
   1. `ros2 launch robot_bringup system.launch.py` (варіант запуску одним launch-файлом)
   2. `ros2 run diff_drive_l298n motor_node`
      `ros2 run camera_driver camera_node` (варіант запуску кожної ноди окремо)

---

### Керування роботом:

1) Рухи вперед/назад: 
   ros2 topic pub /cmd_vel geometry_msgs/msg/Twist `"{linear: {x: +/-0.11, y: 0.0, z:0.0}, angular: {x: 0.0, y: 0.0, z: -/+0.04}}"`
2) Повороти:
   ros2 topic pub /cmd_vel geometry_msgs/msg/Twist `"{linear: {x: 0.0, y: 0.0, z:0.0}, angular: {x: 0.0, y: 0.0, z: -/+z: 2}}"`
3) Зупинка:
   ros2 topic pub /cmd_vel geometry_msgs/msg/Twist `"{linear: {x: -0.0, y: 0.0, z:0.0}, angular: {x: 0.0, y: 0.0, z: 0.0}}" `
### Також є можливість уравляти роботом за допомогою клавіатури (використвоючи стрілочки)
для запуску ноди (keyboard_teleop_node) потрібно ввести команду 
   `ros2 run diff_drive_l298n keyboard_teleop_node`
Аварійну зупинку иожна зробити викриставши комбінацію клавіш Ctrl + C.

---

### Перегляд транцсції камери:
   для перегляду запису камери in real time потрібно ввести в браузері дану команду` http://192.168.0.104:5000`

---

### Для діагностики можна використати такі команди:
1)  `ros2 node list` Виводить список усіх активних нод, які зараз працюють у системі.
2)  `ros2 topic list`Показує всі активні топіки, які зараз існують у ROS-системі.
3)  `ros2 topic echo /cmd_vel`Виводить у реальному часі всі повідомлення, які публікуються в топік /cmd_vel
4)  `ros2 topic echo /image_raw` Виводить дані з камери, які передаються у топік /image_raw.
Тип повідомлення: sensor_msgs/Image

---

### Висновок: 
Розроблений програмний комплекс забезпечує повноцінне керування мобільною роботизованою платформою на базі ROS 2. Реалізовано інтеграцію модулів руху та зору, механізми компенсації механічних похибок, оптимізовану передачу даних та централізований запуск.



   
